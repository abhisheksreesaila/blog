<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Stereo Vision Intro | ABLearn</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Stereo Vision Intro" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Two eyes are better than one?" />
<meta property="og:description" content="Two eyes are better than one?" />
<link rel="canonical" href="https://ablearn.io/computer%20vision/2021/12/07/StereoVision.html" />
<meta property="og:url" content="https://ablearn.io/computer%20vision/2021/12/07/StereoVision.html" />
<meta property="og:site_name" content="ABLearn" />
<meta property="og:image" content="https://ablearn.io/images/post-thumbnails/sv2.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-07T00:00:00-06:00" />
<script type="application/ld+json">
{"headline":"Stereo Vision Intro","description":"Two eyes are better than one?","datePublished":"2021-12-07T00:00:00-06:00","dateModified":"2021-12-07T00:00:00-06:00","image":"https://ablearn.io/images/post-thumbnails/sv2.png","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ablearn.io/computer%20vision/2021/12/07/StereoVision.html"},"url":"https://ablearn.io/computer%20vision/2021/12/07/StereoVision.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://ablearn.io/feed.xml" title="ABLearn" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Stereo Vision Intro | ABLearn</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Stereo Vision Intro" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Two eyes are better than one?" />
<meta property="og:description" content="Two eyes are better than one?" />
<link rel="canonical" href="https://ablearn.io/computer%20vision/2021/12/07/StereoVision.html" />
<meta property="og:url" content="https://ablearn.io/computer%20vision/2021/12/07/StereoVision.html" />
<meta property="og:site_name" content="ABLearn" />
<meta property="og:image" content="https://ablearn.io/images/post-thumbnails/sv2.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-07T00:00:00-06:00" />
<script type="application/ld+json">
{"headline":"Stereo Vision Intro","description":"Two eyes are better than one?","datePublished":"2021-12-07T00:00:00-06:00","dateModified":"2021-12-07T00:00:00-06:00","image":"https://ablearn.io/images/post-thumbnails/sv2.png","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ablearn.io/computer%20vision/2021/12/07/StereoVision.html"},"url":"https://ablearn.io/computer%20vision/2021/12/07/StereoVision.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://ablearn.io/feed.xml" title="ABLearn" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">ABLearn</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Categories</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Stereo Vision Intro</h1><p class="page-description">Two eyes are better than one?</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-12-07T00:00:00-06:00" itemprop="datePublished">
        Dec 7, 2021
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Computer Vision">Computer Vision</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Purpose">Purpose </a></li>
<li class="toc-entry toc-h1"><a href="#Why-do-we-need-Stereo?">Why do we need Stereo? </a>
<ul>
<li class="toc-entry toc-h2"><a href="#The-loss-of-depth">The loss of depth </a>
<ul>
<li class="toc-entry toc-h3"><a href="#How-to-recover?">How to recover? </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Finding-Depth">Finding Depth </a></li>
<li class="toc-entry toc-h2"><a href="#Problems-with-stereo-matching">Problems with stereo matching </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Next-Steps">Next Steps </a></li>
<li class="toc-entry toc-h1"><a href="#References">References </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-12-07-StereoVision.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Purpose">
<a class="anchor" href="#Purpose" aria-hidden="true"><span class="octicon octicon-link"></span></a>Purpose<a class="anchor-link" href="#Purpose"> </a>
</h1>
<p>In this multi-part blog post, we try to understand</p>
<ul>
<li>Why we need stereo in computer vision?</li>
<li>Given any stereo cameras, how can we calibrate and use them to find depth?</li>
<li>Summary of steps</li>
</ul>
<h1 id="Why-do-we-need-Stereo?">
<a class="anchor" href="#Why-do-we-need-Stereo?" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why do we need Stereo?<a class="anchor-link" href="#Why-do-we-need-Stereo?"> </a>
</h1>
<h2 id="The-loss-of-depth">
<a class="anchor" href="#The-loss-of-depth" aria-hidden="true"><span class="octicon octicon-link"></span></a>The loss of depth<a class="anchor-link" href="#The-loss-of-depth"> </a>
</h2>
<p>Given a point in the image plane (U, V), can we find a corresponding point in the world system? The answer is NO.  When we move capture a image we know that 3d world coordinate gets transformed to camera cooridinate and then a 2D image plane. Refer to this blog post for indepth details. Since we loose information, more specifically "Z" depth information, it is impossible to get it back.  In other words, given an image point you cannot reverse engineer WORLD coordinate since you have lost a crucial "Z" coordinate in the translation process. however, you havent lost "X", "Y".  There is hope to get it back, but we need additional help.</p>
<p><img src="https://abhisheksreesaila.github.io/blog/images/stereo/monocular2.png" alt="" title="Loss of Depth"></p>
<p>Since we know "X", "Y", we know it exists somewhere along the line shown as dotted green lines. Why? This was the same line which was used in the projection of object onto the image plane to derive all the math. So, it can also assist in the reverse direction as well.</p>
<p><img src="https://abhisheksreesaila.github.io/blog/images/stereo/projection2.png" alt="" title="Projection of the object on image plane"></p>
<h3 id="How-to-recover?">
<a class="anchor" href="#How-to-recover?" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to recover?<a class="anchor-link" href="#How-to-recover?"> </a>
</h3>
<p>The trick is to understand how nature does this. We all have 2 eyes, and we perceive depth (3d) in all objects. Don't we? The "second eye" provides its view of the world  in addition to the first, and both together work together perceive depth.</p>
<p>Lets apply the same concept here. lets bring in another camera, place it horizontally along the same axis at a distance, find the exact same spot (U, V) on it, guess the point on the "dotted green line".  The intersection of these 2 dotted green lines gives you the depth Z.  See below for the visual</p>
<p><img src="https://abhisheksreesaila.github.io/blog/images/stereo/stereo.png" alt="" title="Stereo Vision"></p>
<ul>
<li>$ u_r v_r $ and  $ u_l v_l $ are the exact same point of the image as seen in the right and left camera respectively</li>
<li>the distance between the cameras is called baseline denoted by b</li>
<li>the camera plane is placed at the pinhole with origin (0,0,0) on the left and (b,0,0) on the right</li>
<li>P (x, y, z) is the scene point that we are trying to compute using the 2 cameras.</li>
</ul>
<p>This concept of using 2 cameras to perceive depth in the real world is called Simple Stereo Vision.  In this blog post lets understand the mechanics of such a system.</p>
<h2 id="Finding-Depth">
<a class="anchor" href="#Finding-Depth" aria-hidden="true"><span class="octicon octicon-link"></span></a>Finding Depth<a class="anchor-link" href="#Finding-Depth"> </a>
</h2>
<p>Lets start with the basics. For a pinhole based camera system we know the following equations</p>
<p>$ u_l = f_x * x/z + O_x $  ;   $ v_l = f_y * y/z  + O_y $</p>
<p>For the right camera, its the same but the camera axis is shifted by "b"</p>
<p>$ u_r = f_x * x/z + O_x $  ;   $ v_r = f_y * y/z  + O_y $</p>
<p>Using the 4 equations, solving for x, y, z  we get</p>
<p>$ x = \frac {b (u_l - O_x)}{ u_l - u_r } $
$ y = \frac {b f_x (v_l - O_y)}{f_y (u_l - u_r)} $</p>
<p><strong>$ z = \frac {b f_x}{ u_l - u_r } $</strong>
</p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg>
    <strong>Note: </strong>$ u_l - u_r $ is called Disparity and its inversely propotional to "z". 
</div>
<div class="flash flash-warn">
    <svg class="octicon octicon-zap octicon octicon-zap octicon octicon-zap octicon octicon-zap octicon octicon-zap octicon octicon-zap octicon octicon-zap octicon octicon-zap octicon octicon-zap octicon octicon-zap octicon octicon-zap" viewbox="0 0 10 16" version="1.1" width="10" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10 7H6l3-7-9 9h4l-3 7 9-9z"></path></svg>
    <strong>Important: </strong>If we know the internal parameters fx, fy, ox, oy and compute disparity, we compute Z and hence the depth. 
</div>
If the object is closer to the camera, you will see a large disparity. for example, U value in the left camera will be 100, whereas the right camera it will be 75.  This is exact same pixel in the image but having 2 different values. The opposite is also true i.e the object is far, there will be very less difference between the U values (Say 100 and 95).  At infinite distance, U values will exactly be the same.
<blockquote>
<p>Disparity is propotional to baseline meaning if the distance between camera increase, disparity will increase.</p>
</blockquote>
<p>I keep mentioning only "U" because there is no $v_l - v_r $ in the equation. which means only the horizontal component between the 2 cameras vary not the "vertical component".  This proporty shows that  $ u_r, v_r $ and $ u_l $ and $ v_l $ lie along the same line (show by the yellow line). when we are computing DISPARITY to solve for X, Y, Z  in the real world, we can pick a point in the left camera $ (u_l, v_l) $ and  ONLY search along the same line in the right camera (and not wander aimlessly and search the whole image) to get the $ u_r, v_r $ .i.e  its a "1D" search problem. See image below for an example. This is often called the <strong>"correspondence problem"</strong></p>
<p><img src="https://abhisheksreesaila.github.io/blog/images/stereo/texture.png" alt="" title="Finding Correspondence">
The white patch in the picture is called the "scan line".</p>
<h2 id="Problems-with-stereo-matching">
<a class="anchor" href="#Problems-with-stereo-matching" aria-hidden="true"><span class="octicon octicon-link"></span></a>Problems with stereo matching<a class="anchor-link" href="#Problems-with-stereo-matching"> </a>
</h2>
<p>Did we solve of finding depth just by solving 2 cameras? yes for the most part, but if the images have the repetitive texture, its impossible to compute disparity and therefore can't compute depth.  see image below.</p>
<p><img src="https://abhisheksreesaila.github.io/blog/images/stereo/no-texture.png" alt="" title="Stereo Vision CANNOT be computed"></p>
<h1 id="Next-Steps">
<a class="anchor" href="#Next-Steps" aria-hidden="true"><span class="octicon octicon-link"></span></a>Next Steps<a class="anchor-link" href="#Next-Steps"> </a>
</h1>
<p>In the next <a href="https://ablearn.io/computer%20vision/2021/12/08/StereoVision-2.html">part</a> we will understand how to calibrate stereo cameras and use them to compute depth</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="References">
<a class="anchor" href="#References" aria-hidden="true"><span class="octicon octicon-link"></span></a>References<a class="anchor-link" href="#References"> </a>
</h1>
<p><a href="https://www.youtube.com/watch?v=hUVyDabn1Mg">Stereo Vision</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="abhisheksreesaila/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/computer%20vision/2021/12/07/StereoVision.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Always Learning</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/abhisheksreesaila" target="_blank" title="abhisheksreesaila"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/asreesaila" target="_blank" title="asreesaila"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
