<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-12-05-Image Features Understanding.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="What-is-a-feature-in-an-image?">What is a feature in an image?<a class="anchor-link" href="#What-is-a-feature-in-an-image?"> </a></h1><p>Features : things that will help us identify the image.  The best features are the ones where by looking at them once you are able to detect the image. Sometime 1 feature is not sufficient and you need to collection of them, each of them helping you identify the image.</p>
<p><img src="https://abhisheksreesaila.github.io/blog/images/stereo/features.png" alt="" title="Image features" /></p>
<p>Look at the following image.  If you pick a patch in the background, it does not tell anything about the image. infact, we can collect hundreds of them and still no use. Lets try something in the middle of the image. again, even If i give you hundreds of them surrounding it, it does not identify the image. Now, lets pick a corner of the image.  IF you closely observe, there can be only 1 corner of that type.  We can pick different corner all of which are unique and help you identify the image.  Hence, you can consider, CORNER make a good collection of features. As such from the early days of computer vision, many algorithms were developed to detect "corners" of the image just because they are good features. 
features</p>
<hr />
<h2 id="Why-do-we-need-features?">Why do we need features?<a class="anchor-link" href="#Why-do-we-need-features?"> </a></h2><p>NEarly all computer vision algorithms in any domain dont just consume the image as a whole and produce an output. They are always preceeded by "feature extraction" and only then peforms their calculation.  (In the world of machine learning, CNN layers are the feature extractors)</p>
<hr />
<h2 id="What-are-feature-descriptors?">What are feature descriptors?<a class="anchor-link" href="#What-are-feature-descriptors?"> </a></h2><p>features are just points on the image (referred to as "keypoints") We need a "describe" them to make it more useful. 
featrure descriptors - as the name suggest, describe the surroudings of a "keypoint" by capturing few vital ingredients around the keypoint. Think of it as vector (a collection) used to describe.  A good analogy would be a persons face.  "eye", "color of the skin", "hair" etc. are features.  color of the eye is "brown", color is "black/brown/white", "Grey/Black/Blonde" hair color are feature descriptors</p>
<hr />
<h2 id="What-is-feature-matching?">What is feature matching?<a class="anchor-link" href="#What-is-feature-matching?"> </a></h2><p>Given 2 images, we want to compare the features between each other. If they are similar images, then we will end up high degree of "matches" else we wont. its simple.</p>
<h3 id="Ok-why-is-this-useful?">Ok why is this useful?<a class="anchor-link" href="#Ok-why-is-this-useful?"> </a></h3><p>By tracking the features between 2 images, we can begin to understand if and how the objects in the images are "moving". By doing this over mulltiple images, we can "track" the moving objects within an image, movement of a camera w.r.t to the image etc.</p>
<hr />
<p>The full working code is available <a href="https://colab.research.google.com/drive/1rUtldAJRTyVpeB8zJmfWUEO3Bo16qifz#scrollTo=DVvf09RdXh9c">here</a> in google colab</p>
<hr />
<h2 id="Use-OpenCV-to-detect-features-and-feature-description">Use OpenCV to detect features and feature description<a class="anchor-link" href="#Use-OpenCV-to-detect-features-and-feature-description"> </a></h2><div class="highlight"><pre><span></span><span class="c1">#Load Different Image Pairs</span>
<span class="n">img1</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;images/image0.jpg&quot;</span><span class="p">)</span>
<span class="n">img2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;images/image1.jpg&quot;</span><span class="p">)</span>

<span class="c1"># INITIALIZE FAST DETECTOR</span>
<span class="n">fast</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FastFeatureDetector_create</span><span class="p">()</span>
<span class="n">kp</span> <span class="o">=</span> <span class="n">fast</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># BRIEF DESCRIPTOR</span>
<span class="n">brief</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">xfeatures2d</span><span class="o">.</span><span class="n">BriefDescriptorExtractor_create</span><span class="p">()</span>
<span class="n">kp1</span><span class="p">,</span> <span class="n">des1</span> <span class="o">=</span> <span class="n">brief</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span>

<span class="c1"># KEYPOINTS DRAWN</span>
<span class="n">img1_kp</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">drawKeypoints</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">kp1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cv2_imshow</span><span class="p">(</span><span class="n">img1_kp</span><span class="p">)</span>
</pre></div>
<p><img src="https://abhisheksreesaila.github.io/blog/images/stereo/feature1.png" alt="" title="Image 1 - Features" /></p>
<hr />
<div class="highlight"><pre><span></span><span class="c1">#REPEAT for the next image</span>

<span class="n">kp</span> <span class="o">=</span> <span class="n">fast</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">kp2</span><span class="p">,</span> <span class="n">des2</span> <span class="o">=</span> <span class="n">brief</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span>
<span class="n">img2_kp</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">drawKeypoints</span><span class="p">(</span><span class="n">img2</span><span class="p">,</span> <span class="n">kp2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cv2_imshow</span><span class="p">(</span><span class="n">img2_kp</span><span class="p">)</span>
</pre></div>
<p><img src="https://abhisheksreesaila.github.io/blog/images/stereo/feature2.png" alt="" title="Image 2 - Features" /></p>
<hr />
<div class="highlight"><pre><span></span><span class="c1">#FLANN MATCHING</span>
<span class="n">FLANN_INDEX_KDTREE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">index_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">FLANN_INDEX_KDTREE</span><span class="p">,</span> <span class="n">trees</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">search_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">checks</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>

<span class="n">flann</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">DescriptorMatcher_create</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">DescriptorMatcher_FLANNBASED</span><span class="p">)</span>

<span class="n">des1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">des1</span><span class="p">)</span>
<span class="n">des2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">des2</span><span class="p">)</span>

<span class="n">matches</span> <span class="o">=</span> <span class="n">flann</span><span class="o">.</span><span class="n">knnMatch</span><span class="p">(</span><span class="n">des1</span><span class="p">,</span> <span class="n">des2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># store all the good matches as per Lowe&#39;s ratio test.</span>
<span class="n">good</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">m</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="mf">0.7</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">distance</span><span class="p">:</span>
        <span class="n">good</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">draw_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">matchColor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># draw matches in green color</span>
                    <span class="n">singlePointColor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">flags</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">img_briefmatch</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">drawMatches</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span><span class="n">kp1</span><span class="p">,</span><span class="n">img2</span><span class="p">,</span><span class="n">kp2</span><span class="p">,</span><span class="n">good</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">draw_params</span><span class="p">)</span>
<span class="n">cv2_imshow</span><span class="p">(</span><span class="n">img_briefmatch</span><span class="p">)</span>
</pre></div>
<p><img src="https://abhisheksreesaila.github.io/blog/images/stereo/imatching.png" alt="" title="Image Matching" /></p>

</div>
</div>
</div>
</div>

